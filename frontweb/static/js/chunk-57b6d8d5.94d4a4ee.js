(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-57b6d8d5"],{"09d4":function(e,t,a){"use strict";var r=a("6400"),i=a.n(r);i.a},"0b18":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"add-interface-container auto-height"},[e.isEditParams?e._e():a("div",{staticClass:"add-interface-title"},[e._v("\n    "+e._s(e.isEdit?"编辑接口":"新建接口")+"\n  ")]),e._v(" "),a("el-form",{ref:"interfaceForm",attrs:{model:e.form,rules:e.interfaceFormRules,"label-position":"left","hide-required-asterisk":"",inline:!0}},[a("el-form-item",{staticClass:"form-block-item",attrs:{label:"接口名称",prop:"name"}},[a("el-input",{attrs:{disabled:e.isEditParams},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{staticClass:"form-block-item",attrs:{label:"接口描述",prop:"desc"}},[a("el-input",{attrs:{type:"textarea",resize:"none",disabled:e.isEditParams},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1),e._v(" "),a("el-form-item",{staticClass:"label-protocol",attrs:{label:"请求协议",prop:"request_protocol","label-width":"4.1667vw"}},[a("el-select",{attrs:{disabled:e.isEditParams},model:{value:e.form.request_protocol,callback:function(t){e.$set(e.form,"request_protocol",t)},expression:"form.request_protocol"}},e._l(e.optionsProtocol,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"服务器名 or IP",prop:"template_server"}},[a("el-select",{attrs:{disabled:e.isEditParams},model:{value:e.form.template_server,callback:function(t){e.$set(e.form,"template_server",t)},expression:"form.template_server"}},e._l(e.serverList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"端口",prop:"template_port"}},[a("el-select",{attrs:{disabled:e.isEditParams},model:{value:e.form.template_port,callback:function(t){e.$set(e.form,"template_port",t)},expression:"form.template_port"}},e._l(e.serverList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"请求方式",prop:"request_way"}},[a("el-select",{attrs:{placeholder:"HttpMethod",disabled:e.isEditParams},model:{value:e.form.request_way,callback:function(t){e.$set(e.form,"request_way",t)},expression:"form.request_way"}},e._l(e.optionsHttpMethod,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"路径",prop:"path_url"}},[a("el-input",{attrs:{placeholder:"url",disabled:e.isEditParams},model:{value:e.form.path_url,callback:function(t){e.$set(e.form,"path_url",t)},expression:"form.path_url"}})],1),e._v(" "),a("el-tabs",{staticClass:"param-tabs",attrs:{type:"border-card"},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("el-tab-pane",{attrs:{label:"PARAMS",name:"params"}},[a("HttpKeyValueTable",{attrs:{type:"query","key-value-list":e.paramsList},on:{"update:keyValueList":function(t){e.paramsList=t},"update:key-value-list":function(t){e.paramsList=t}}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"HEADER",name:"header"}},[a("HttpKeyValueTable",{attrs:{type:"keyValue","key-value-list":e.headerList}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"BODY",name:"body"}},[a("div",{staticClass:"body-radio-line clearfix"},[e._l(e.optionsBodyType,(function(t){return a("el-radio",{key:t.value,attrs:{label:t.value},model:{value:e.form.bodyformat,callback:function(t){e.$set(e.form,"bodyformat",t)},expression:"form.bodyformat"}},[e._v(e._s(t.label))])})),e._v(" "),3===e.form.bodyformat?a("el-select",{staticStyle:{float:"right"},attrs:{placeholder:"HttpMethod",size:"mini"},model:{value:e.form.bodymessageformat,callback:function(t){e.$set(e.form,"bodymessageformat",t)},expression:"form.bodymessageformat"}},e._l(e.optionsBodyRayType,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):e._e()],2),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1===e.form.bodyformat,expression:"form.bodyformat === 1"}]},[a("HttpKeyValueTable",{attrs:{type:"file","key-value-list":e.bodyFormList}})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:2===e.form.bodyformat,expression:"form.bodyformat === 2"}]},[a("HttpKeyValueTable",{attrs:{type:"query","key-value-list":e.bodyAppList}})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:3===e.form.bodyformat,expression:"form.bodyformat === 3"}],staticClass:"body-type-box"},[a("div",{directives:[{name:"show",rawName:"v-show",value:3===e.form.bodymessageformat,expression:"form.bodymessageformat === 3"}],staticClass:"left hover-primary",on:{click:e.toggleTreeView}},[e._v("\n            "+e._s(e.isShowTreeView?"Original":"Tree View")+"\n          ")]),e._v(" "),a("div",{staticClass:"right"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowTreeView&&3===e.form.bodymessageformat,expression:"isShowTreeView && form.bodymessageformat === 3"}]},[a("JsonTree",{attrs:{data:e.bodyRawJsonObject}})],1),e._v(" "),a("div",[e.plainEditorInited?a("codeEditor",{directives:[{name:"show",rawName:"v-show",value:1===e.form.bodymessageformat,expression:"form.bodymessageformat === 1"}],ref:"CodeEditor1",attrs:{mode:""},model:{value:e.form.bodyRawTextPlain,callback:function(t){e.$set(e.form,"bodyRawTextPlain",t)},expression:"form.bodyRawTextPlain"}}):e._e(),e._v(" "),e.jSEditorInited?a("codeEditor",{directives:[{name:"show",rawName:"v-show",value:2===e.form.bodymessageformat,expression:"form.bodymessageformat === 2"}],ref:"CodeEditor2",attrs:{mode:"javascript"},model:{value:e.form.bodyRawTextJS,callback:function(t){e.$set(e.form,"bodyRawTextJS",t)},expression:"form.bodyRawTextJS"}}):e._e(),e._v(" "),e.jsonEditorInited?a("codeEditor",{directives:[{name:"show",rawName:"v-show",value:3===e.form.bodymessageformat&&!e.isShowTreeView,expression:"form.bodymessageformat === 3 && !isShowTreeView"}],ref:"CodeEditor3",attrs:{mode:"application/json"},model:{value:e.bodyRawJsonObject,callback:function(t){e.bodyRawJsonObject=t},expression:"bodyRawJsonObject"}}):e._e(),e._v(" "),e.htmlEditorInited?a("codeEditor",{directives:[{name:"show",rawName:"v-show",value:4===e.form.bodymessageformat,expression:"form.bodymessageformat === 4"}],ref:"CodeEditor4",attrs:{mode:"htmlmixed"},model:{value:e.form.bodyRawTextHTML,callback:function(t){e.$set(e.form,"bodyRawTextHTML",t)},expression:"form.bodyRawTextHTML"}}):e._e(),e._v(" "),e.xmlEditorInited?a("codeEditor",{directives:[{name:"show",rawName:"v-show",value:5===e.form.bodymessageformat,expression:"form.bodymessageformat === 5"}],ref:"CodeEditor5",attrs:{mode:"xml"},model:{value:e.form.bodyRawTextXML,callback:function(t){e.$set(e.form,"bodyRawTextXML",t)},expression:"form.bodyRawTextXML"}}):e._e()],1)])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"4"===e.form.bodyformat,expression:"form.bodyformat === '4'"}]},[a("FileUpload",{attrs:{action:"/"},model:{value:e.bodyBinaryFile,callback:function(t){e.bodyBinaryFile=t},expression:"bodyBinaryFile"}})],1)]),e._v(" "),a("el-tab-pane",{attrs:{label:"前置处理",name:"prependScript"}},[a("div",{staticClass:"code-editor-container"},[a("div",{staticClass:"left"},[a("div",{staticClass:"code-error-msg"},[e._v(e._s(e.prependScriptError||" "))]),e._v(" "),e.prependEditorInited?a("codeEditor",{ref:"CodeEditor6",attrs:{mode:"python"},model:{value:e.prependScript,callback:function(t){e.prependScript=t},expression:"prependScript"}}):e._e()],1),e._v(" "),a("div",{staticClass:"right"},[a("div",{staticClass:"title"},[e._v("关键字")]),e._v(" "),a("div",{staticClass:"key-words-wrapper"},e._l(e.allKeyWords,(function(t){return a("el-popover",{key:"keywords_"+t.id,attrs:{placement:"left",title:"提示",width:"200",trigger:"hover",content:t.desc}},[a("div",{staticClass:"item",attrs:{slot:"reference"},on:{click:function(a){return e.insertKeyWord(t)}},slot:"reference"},[e._v("\n                  "+e._s(t.name)+"\n                ")])])})),1)])])]),e._v(" "),a("el-tab-pane",{attrs:{label:"后置处理",name:"appendScript"}},[a("div",{staticClass:"code-editor-container"},[a("div",{staticClass:"left"},[a("div",{staticClass:"code-error-msg"},[e._v(e._s(e.appendScriptError||" "))]),e._v(" "),e.appendEditorInited?a("codeEditor",{ref:"CodeEditor7",attrs:{mode:"python"},model:{value:e.appendScript,callback:function(t){e.appendScript=t},expression:"appendScript"}}):e._e()],1),e._v(" "),a("div",{staticClass:"right"},[a("div",{staticClass:"title"},[e._v("关键字")]),e._v(" "),a("div",{staticClass:"key-words-wrapper"},e._l(e.allKeyWords,(function(t){return a("el-popover",{key:"keywords_"+t.id,attrs:{placement:"left",title:"提示",width:"200",trigger:"hover",content:t.desc}},[a("div",{staticClass:"item",attrs:{slot:"reference"},on:{click:function(a){return e.insertKeyWord(t)}},slot:"reference"},[e._v("\n                  "+e._s(t.name)+"\n                ")])])})),1)])])]),e._v(" "),a("el-tab-pane",{attrs:{label:"提取变量",name:"extractScript"}},[a("div",{staticClass:"code-editor-container"},[a("div",{staticClass:"left"},[a("div",{staticClass:"code-error-msg"},[e._v(e._s(e.extractScriptError||" "))]),e._v(" "),e.extractEditorInited?a("codeEditor",{ref:"CodeEditor9",attrs:{mode:"python"},model:{value:e.extractScript,callback:function(t){e.extractScript=t},expression:"extractScript"}}):e._e()],1),e._v(" "),a("div",{staticClass:"right"},[a("div",{staticClass:"title"},[e._v("关键字")]),e._v(" "),a("div",{staticClass:"key-words-wrapper"},e._l(e.allKeyWords,(function(t){return a("el-popover",{key:"keywords_"+t.id,attrs:{placement:"left",title:"提示",width:"200",trigger:"hover",content:t.desc}},[a("div",{staticClass:"item",attrs:{slot:"reference"},on:{click:function(a){return e.insertKeyWord(t)}},slot:"reference"},[e._v("\n                  "+e._s(t.name)+"\n                ")])])})),1)])])]),e._v(" "),a("el-tab-pane",{attrs:{label:"断言",name:"assertScript"}},[a("div",{staticClass:"code-editor-container"},[a("div",{staticClass:"left"},[a("div",{staticClass:"code-error-msg"},[e._v(e._s(e.assertScriptError||" "))]),e._v(" "),e.assertEditorInited?a("codeEditor",{ref:"CodeEditor8",attrs:{mode:"python"},model:{value:e.assertScript,callback:function(t){e.assertScript=t},expression:"assertScript"}}):e._e()],1),e._v(" "),a("div",{staticClass:"right"},[a("div",{staticClass:"title"},[e._v("关键字")]),e._v(" "),a("div",{staticClass:"key-words-wrapper"},e._l(e.allKeyWords,(function(t){return a("el-popover",{key:"keywords_"+t.id,attrs:{placement:"left",title:"提示",width:"200",trigger:"hover",content:t.desc}},[a("div",{staticClass:"item",attrs:{slot:"reference"},on:{click:function(a){return e.insertKeyWord(t)}},slot:"reference"},[e._v("\n                  "+e._s(t.name)+"\n                ")])])})),1)])])])],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("span",{staticClass:"app-btn app-btn-green",on:{click:e.handleExport}},[e._v("导出数据源\n    ")]),e._v(" "),a("span",{staticClass:"app-btn app-btn-blue",on:{click:e.handleConfirm}},[e._v("保 存\n    ")]),e._v(" "),a("span",{staticClass:"app-btn app-btn-white",on:{click:e.handleCancel}},[e._v("返 回\n    ")])]),e._v(" "),a("aside")],1)},i=[],n=(a("456d"),a("db72")),s=(a("4917"),a("75fc")),o=(a("5df3"),a("6762"),a("2fdb"),a("7f7f"),a("ac4d"),a("8a81"),a("ac6a"),a("2a75")),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"http-table-container"},["file"===e.type?[a("el-row",{staticClass:"table-head"},[a("el-col",{attrs:{span:6}},[e._v("Key")]),e._v(" "),a("el-col",{attrs:{span:18}},[e._v("变量名")])],1),e._v(" "),a("keyValueTable",{attrs:{type:"file","key-value-list":e.keyValueList}})]:[a("el-row",{staticClass:"table-head"},[a("el-col",{attrs:{span:4}},[e._v("Key")]),e._v(" "),a("el-col",{attrs:{span:8}},[e._v("变量名")]),e._v(" "),a("el-col",{attrs:{span:12}},[e._v("\n        变量描述\n        "),"query"===e.type?a("el-button",{staticClass:"btn-params-switch",attrs:{type:"primary",size:"mini"},on:{click:e.switchParamsDisplay}},[e._v(e._s(e.isShowParamsString?"key-value":"原始"))]):e._e()],1)],1),e._v(" "),"query"===e.type?a("el-input",{directives:[{name:"show",rawName:"v-show",value:e.isShowParamsString,expression:"isShowParamsString"}],attrs:{type:"textarea"},model:{value:e.paramsString,callback:function(t){e.paramsString=t},expression:"paramsString"}}):e._e(),e._v(" "),a("keyValueTable",{directives:[{name:"show",rawName:"v-show",value:"keyValue"===e.type||!e.isShowParamsString,expression:"type==='keyValue' || !isShowParamsString"}],attrs:{"key-value-list":e.keyValueList}})]],2)},c=[],d=a("768b"),u=(a("28a5"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ul",{staticClass:"key-value-table-container"},[e._l(e.keyValueList,(function(t,r){return a("li",{key:r},["file"===e.type?a("el-row",[a("el-col",{attrs:{span:4}},[a("el-input",{ref:"input-key-"+r,refInFor:!0,attrs:{size:"mini"},model:{value:t.key,callback:function(a){e.$set(t,"key",a)},expression:"item.key"}})],1),e._v(" "),a("el-col",{attrs:{span:3}},[a("el-select",{attrs:{size:"mini"},model:{value:t.valueType,callback:function(a){e.$set(t,"valueType",a)},expression:"item.valueType"}},[a("el-option",{attrs:{label:"text",value:"text"}}),e._v(" "),a("el-option",{attrs:{label:"file",value:"file"}})],1)],1),e._v(" "),a("el-col",{staticClass:"col-padding",attrs:{span:17}},[a("el-input",{directives:[{name:"show",rawName:"v-show",value:!t.valueType||"text"===t.valueType,expression:"!item.valueType || item.valueType === 'text'"}],ref:"input-value-"+r,refInFor:!0,attrs:{size:"mini"},model:{value:t.textValue,callback:function(a){e.$set(t,"textValue",a)},expression:"item.textValue"}}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"file"===t.valueType,expression:"item.valueType === 'file'"}]},[a("FileUpload",{ref:"upload-"+r,refInFor:!0,attrs:{action:"/"},model:{value:t.files,callback:function(a){e.$set(t,"files",a)},expression:"item.files"}})],1),e._v(" "),a("span",{staticClass:"button-delete",on:{click:function(t){e.keyValueList.length>1&&e.keyValueList.splice(r,1)}}},[e._v("x\n        ")])],1)],1):a("el-row",[a("el-col",{attrs:{span:4}},[a("el-input",{ref:"input-key-"+r,refInFor:!0,attrs:{size:"mini"},model:{value:t.key,callback:function(a){e.$set(t,"key",a)},expression:"item.key"}})],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-input",{ref:"input-value-"+r,refInFor:!0,attrs:{size:"mini"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1),e._v(" "),a("el-col",{staticClass:"col-padding",attrs:{span:12}},[a("el-input",{ref:"input-desc-"+r,refInFor:!0,attrs:{size:"mini"},model:{value:t.desc,callback:function(a){e.$set(t,"desc",a)},expression:"item.desc"}}),e._v(" "),a("span",{staticClass:"button-delete",on:{click:function(t){e.keyValueList.length>1&&e.keyValueList.splice(r,1)}}},[e._v("x\n        ")])],1)],1)],1)})),e._v(" "),a("li",{staticClass:"table-item-add"},[a("el-row",[a("el-col",{attrs:{span:4}},[a("el-input",{attrs:{size:"mini"},nativeOn:{click:function(t){return e.addItem("key")}}})],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{size:"mini"},nativeOn:{click:function(t){return e.addItem("value")}}})],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{size:"mini"},nativeOn:{click:function(t){return e.addItem("desc")}}})],1)],1)],1)],2)}),p=[],m={components:{FileUpload:o["a"]},props:{type:{type:String,default:""},keyValueList:{type:Array,default:function(){return[{}]}}},methods:{addItem:function(e){this.keyValueList.push({}),this.focusLastItem(e)},focusLastItem:function(e){var t=this;this.$nextTick((function(){var a=t.keyValueList.length-1;"key"===e?t.$refs["input-key-".concat(a)][0].focus():"value"===e?t.$refs["input-value-".concat(a)][0].focus():"desc"===e&&t.$refs["input-value-".concat(a)][0].focus()}))}}},f=m,v=(a("f15a"),a("2877")),h=Object(v["a"])(f,u,p,!1,null,null,null),b=h.exports,y={components:{KeyValueTable:b},props:{keyValueList:{type:Array,required:!0},type:{validator:function(e){return-1!==["query","keyValue","file"].indexOf(e)},default:"query"}},data:function(){return{isShowParamsString:!1,paramsString:""}},computed:{descMap:function(){var e={},t=!0,a=!1,r=void 0;try{for(var i,n=this.keyValueList[Symbol.iterator]();!(t=(i=n.next()).done);t=!0){var s=i.value;s.key&&s.desc&&(e[s.key]=s.desc)}}catch(o){a=!0,r=o}finally{try{t||null==n.return||n.return()}finally{if(a)throw r}}return e}},methods:{switchParamsDisplay:function(){var e=this;if(this.isShowParamsString){var t=function(t){return t.split("&").map((function(t){var a=t.split("="),r=Object(d["a"])(a,2),i=r[0],n=r[1];return{key:i,value:n,desc:e.descMap[i]}}))};this.isShowParamsString=!1,this.$emit("update:keyValueList",t(this.paramsString))}else{var a=function(e){var t="";return e.forEach((function(e){var a=e.key,r=e.value;a&&r&&(t+="&".concat(a,"=").concat(r))})),t.substring(1)};this.isShowParamsString=!0,this.paramsString=a(this.keyValueList)}}}},g=y,_=(a("e658"),Object(v["a"])(g,l,c,!1,null,"8f7672c6",null)),w=_.exports,E=a("7fab"),S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"json-editor"},[a("textarea",{ref:"textarea"})])},x=[],k=a("56b3"),C=a.n(k);a("0dd0"),a("a7be"),a("acdf"),a("f9d4"),a("d5e0"),a("d69f"),a("db91"),a("8822"),a("d2de"),a("3c98"),a("2768"),a("92f1"),a("f4ba");a("ae67");var T={name:"CodeEditor",props:{value:{type:[Object,String],default:""},mode:{type:String,default:"application/json"}},data:function(){return{codeEditor:!1}},watch:{value:function(e){if("application/json"!==this.mode){var t=this.codeEditor.getValue();e!==t&&this.codeEditor.setValue(this.value)}}},mounted:function(){var e=this;this.codeEditor=C.a.fromTextArea(this.$refs.textarea,{lineNumbers:!0,mode:this.mode,gutters:["CodeMirror-lint-markers"],lint:!0,autoRefresh:!0}),"application/json"===this.mode?this.codeEditor.setValue(JSON.stringify(this.value,null,2)):this.codeEditor.setValue(this.value),this.codeEditor.on("change",(function(t){if(e.$emit("changed",t.getValue()),"application/json"===e.mode)try{var a=JSON.parse(t.getValue());e.$emit("input",a)}catch(r){e.$emit("input",null)}else e.$emit("input",t.getValue())}))},methods:{getValue:function(){return this.codeEditor.getValue()},getEditor:function(){return this.codeEditor},replaceSelection:function(){var e;return(e=this.codeEditor).replaceSelection.apply(e,arguments)},newLine:function(){C.a.commands.newlineAndIndent(this.codeEditor)}}},j=T,O=(a("09d4"),Object(v["a"])(j,S,x,!1,null,"b1e75452",null)),I=O.exports,$=a("24d2"),L=a("2226"),V=(a("a481"),a("01c8"));function P(e,t){if(e&&t){var a=function(e){var a=e.funcName,r=e.args,i=e.assign,n=t[a];return n?{keyword:a,args:r,assign:i}:new Error("不存在的方法名: ".concat(a))},r=function(e){var t=e.indexOf("=    ")>-1;if(t){var r=e.split("=    ");if(r.length>2)return new Error("语法错误: ".concat(e));var i=Object(d["a"])(r,2),n=i[0],s=i[1],o=n.split("    ");if(!o)return new Error("缺少返回参数: ".concat(e));var l=s.split("    ");if(l.length<2)return new Error("缺少方法参数: ".concat(e));var c=Object(V["a"])(l),u=c[0],p=c.slice(1),m={funcName:u,args:p.filter((function(e){return e})),assign:o.filter((function(e){return e}))};return a(m)}var f=e.split("    "),v=Object(V["a"])(f),h=v[0],b=v.slice(1),y={funcName:h,args:b.filter((function(e){return e}))};return a(y)},i=e.replace(/\n/g,"").split(";"),n=[],s=!0,o=!1,l=void 0;try{for(var c,u=i[Symbol.iterator]();!(s=(c=u.next()).done);s=!0){var p=c.value;if(p){var m=r(p);if(m instanceof Error)return m;n.push(m)}}}catch(f){o=!0,l=f}finally{try{s||null==u.return||u.return()}finally{if(o)throw l}}return n}}var D={name:[{required:!0,trigger:"blur",message:"请填写接口名称"}],desc:[{required:!0,trigger:"blur",message:"请填写接口描述"}],request_protocol:[{required:!0,trigger:"change",message:"请选择协议"}],template_server:[{required:!0,trigger:"change",message:"请选择服务器"}],template_port:[{required:!0,trigger:"blur",message:"请填写端口"}],request_way:[{required:!0,trigger:"change",message:"请选择请求方式"}],path_url:[{required:!0,trigger:"blur",message:"请填写路径"}]},R=[{label:"http",value:1},{label:"https",value:2}],q=[{label:"Text",value:1},{label:"Javascript",value:2},{label:"JSON",value:3},{label:"HTML",value:4},{label:"XML",value:5}],F=[{label:"GET",value:1},{label:"POST",value:2},{label:"PUT",value:3},{label:"DELETE",value:4}],N=[{label:"form-data",value:1},{label:"x-www-form-urlencoded-data",value:2},{label:"raw-data",value:3},{label:"binary",value:4}],J=function(e){var t="";if(e.return_args){var a=!0,r=!1,i=void 0;try{for(var n,s=e.return_args[Symbol.iterator]();!(a=(n=s.next()).done);a=!0){var o=n.value;t+="".concat(o,"    ")}}catch(v){r=!0,i=v}finally{try{a||null==s.return||s.return()}finally{if(r)throw i}}t=t.substring(0,t.length-4)+"=    "}var l="";if(e.args){var c=!0,d=!1,u=void 0;try{for(var p,m=e.args[Symbol.iterator]();!(c=(p=m.next()).done);c=!0){var f=p.value;l+="".concat(f,"    ")}}catch(v){d=!0,u=v}finally{try{c||null==m.return||m.return()}finally{if(d)throw u}}l="    "+l.substring(0,l.length-4)}return"".concat(t).concat(e.name).concat(l,";")},K=function(e){if(e){var t="";return e.forEach((function(e){var a=e.keyword,r=e.args,i=e.assign,n=J({name:a,args:r,return_args:i});t+="".concat(n,"\n")})),t}},M={components:{FileUpload:o["a"],HttpKeyValueTable:w,JsonTree:E["a"],CodeEditor:I},props:{isEditParams:{type:Boolean,default:!1},defaultInterface:{type:Object,default:null},needsDiffData:{type:Boolean,default:!1}},data:function(){return{form:{name:"",desc:"",request_protocol:"",template_server:"",template_port:"",request_way:"",path_url:"",encode:"",bodyformat:3,bodymessageformat:"",bodyRawTextPlain:"",bodyRawTextJS:"",bodyRawTextHTML:"",bodyRawTextXML:""},activeTab:"params",paramsList:[{}],headerList:[{}],bodyFormList:[{}],bodyAppList:[{}],bodyRawJsonObject:{},bodyBinaryFile:[],prependScript:"",prependScriptError:"",prependScriptCompile:[],appendScript:"",appendScriptError:"",appendScriptCompile:[],extractScript:"",extractScriptError:"",extractScriptCompile:[],assertScript:"",assertScriptError:"",assertScriptCompile:[],allKeyWords:[],serverList:[],isShowTreeView:!1,plainEditorInited:!1,jsonEditorInited:!1,jSEditorInited:!1,xmlEditorInited:!1,htmlEditorInited:!1,prependEditorInited:!1,appendEditorInited:!1,assertEditorInited:!1,extractEditorInited:!1,optionsBodyRayType:q,optionsHttpMethod:F,optionsBodyType:N,optionsProtocol:R,loading:!1,interfaceFormRules:D}},computed:{isEdit:function(){return"InterfaceEdit"===this.$route.name},projectId:function(){return this.$route.params.projectId},interface:function(){return this.isEditParams?this.defaultInterface:this.$route.params.interface},moduleId:function(){return this.isEdit?this.interface.intermodule:this.$route.params.moduleId},activeCodeEditor:function(){return"prependScript"===this.activeTab?this.$refs.CodeEditor6:"appendScript"===this.activeTab?this.$refs.CodeEditor7:"assertScript"===this.activeTab?this.$refs.CodeEditor8:"extractScript"===this.activeTab?this.$refs.CodeEditor9:null},showKeyWordsPanel:function(){return["prependScript","appendScript","assertScript","extractScript"].includes(this.activeTab)},compileRule:function(){return this.allKeyWords.reduce((function(e,t){var a=t.id,r=t.args,i=t.return_args;return e[t.name]={id:a,args:r,return_args:i},e}),{})},paramsListData:function(){return this.getParams(this.paramsList)},headerListData:function(){return this.getParams(this.headerList)},hasScriptError:function(){return this.prependScriptError||this.appendScriptError||this.extractScriptError||this.assertScriptError}},watch:{interface:{handler:function(){this.initInterfaceFormData()}},"form.bodymessageformat":{handler:function(e){1===e?this.plainEditorInited=!0:2===e?this.jSEditorInited=!0:3===e?this.jsonEditorInited=!0:4===e?this.htmlEditorInited=!0:5===e&&(this.xmlEditorInited=!0)},immediate:!0},activeTab:{handler:function(e){"prependScript"===e?this.prependEditorInited=!0:"appendScript"===e?this.appendEditorInited=!0:"assertScript"===e?this.assertEditorInited=!0:"extractScript"===e&&(this.extractEditorInited=!0)}},prependScript:{handler:function(e){var t=P(e,this.compileRule);t instanceof Error?this.prependScriptError=t.message:(this.prependScriptError="",this.prependScriptCompile=t||[])}},appendScript:{handler:function(e){var t=P(e,this.compileRule);t instanceof Error?this.appendScriptError=t.message:(this.appendScriptError="",this.appendScriptCompile=t||[])}},extractScript:{handler:function(e){var t=P(e,this.compileRule);t instanceof Error?this.extractScriptError=t.message:(this.extractScriptError="",this.extractScriptCompile=t||[])}},assertScript:{handler:function(e){var t=P(e,this.compileRule);t instanceof Error?this.assertScriptError=t.message:(this.assertScriptError="",this.assertScriptCompile=t||[])}}},beforeRouteEnter:function(e,t,a){"InterfaceEdit"!==e.name||e.params.interface?a():Object(L["l"])({id:e.params.interfaceId}).then((function(t){e.params.interface=t.data,a()}))},created:function(){var e=this;this.loading=!0,Promise.all([this.initKeyWords(),this.initServerList()]).then((function(t){e.initInterfaceFormData()})).finally((function(t){e.loading=!1}))},methods:{initKeyWords:function(){var e=this;return Object(L["i"])().then((function(t){e.allKeyWords=t.data}))},initServerList:function(){var e=this;return Object($["h"])({id:this.projectId}).then((function(t){var a=t.data;e.serverList=a}))},initInterfaceFormData:function(){if(this.interface){var e=this.interface,t=e.name,a=e.desc,r=e.request_protocol,i=e.template_server,n=e.template_port,s=e.request_way,o=e.path_url,l=e.bodyformat,c=e.bodymessageformat,d=e.params,u=e.headerparams,p=e.bodyparams,m=e.preprocessing,f=e.postprocessing,v=e.assertion,h=e.variable;for(var b in this.originFormData={name:t,desc:a,request_protocol:r,template_server:i,template_port:n,request_way:s,path_url:o,bodyformat:l,bodymessageformat:c},this.originParamData={params:d,headerparams:u,bodyparams:p,preprocessing:m,postprocessing:f,assertion:v,variable:h},this.originFormData)this.form[b]=this.originFormData[b];d&&(this.paramsList=d.map((function(e){var t=e.paramname,a=e.variable_name,r=e.desc;return{key:t,value:a,desc:r}}))),u&&(this.headerList=u.map((function(e){var t=e.paramname,a=e.variable_name,r=e.desc;return{key:t,value:a,desc:r}}))),this.bodyRawJsonObject=p,this.prependScript=K(m),this.appendScript=K(f),this.assertScript=K(v),this.extractScript=K(h)}else this.form.bodymessageformat=3},toggleTreeView:function(){this.isShowTreeView=!this.isShowTreeView},insertKeyWord:function(e){this.activeCodeEditor&&(this.activeCodeEditor.replaceSelection(J(e)),this.activeCodeEditor.newLine())},compileScript:function(e){P(e,this.compileRule)},handleCancel:function(){this.isEditParams?this.$emit("close"):this.$router.go(-1)},handleExport:function(){var e=this;this.$confirm("从当前页面导出数据源, 是否继续?","提示").then((function(t){e.loading=!0,Promise.all([a.e("chunk-69c64115"),a.e("chunk-58293907")]).then(a.bind(null,"4bf8d")).then((function(t){var a=["变量","变量说明","变量位置","值1","值2"],r=["variable_name","desc","position"],i=[{variable_name:"TestName",desc:"用例说明",position:"other"},{variable_name:"TestDesc",desc:"用例说明",position:"other"},{variable_name:"TestTags",desc:"用例标签",position:"other"}].concat(Object(s["a"])(e.getExcelData(e.paramsListData,"params")),Object(s["a"])(e.getExcelData(e.headerListData,"header")),Object(s["a"])(e.getExcelData(e.bodyRawJsonObject,"body")),Object(s["a"])(e.getExcelData(e.prependScriptCompile,"prepend")),Object(s["a"])(e.getExcelData(e.appendScriptCompile,"append")),Object(s["a"])(e.getExcelData(e.assertScriptCompile,"assert")),Object(s["a"])(e.getExcelData(e.extractScriptCompile,"variable")));t.export_json_to_excel({header:a,data:e.formatJson(r,i),filename:"接口数据源导出文件",autoWidth:!0,bookType:"xlsx"})})).finally((function(t){e.loading=!1}))})).catch((function(e){}))},getExcelData:function(e,t){if("params"===t||"header"===t)return e.map((function(e){var a=e.variable_name,r=e.desc;return{variable_name:a,desc:r,position:t}}));if("body"===t){var a=JSON.stringify(e).match(/\${[^${}]*}/g);return a?a.map((function(e){var a=e.match(/^\${(.*)}$/)[1];return{variable_name:a,position:t}})):[]}if("prepend"===t||"append"===t||"assert"===t){var r=[];return e.forEach((function(e){var a=e.assign,i=e.args,n=function(e){var a=e.match(/^\${(.*)}$/);a&&a[1]&&r.push({variable_name:a[1],position:t})};a&&a.forEach(n),i&&i.forEach(n)})),r}},formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return t[e]}))}))},handleConfirm:function(){var e=this;this.$refs.interfaceForm.validate((function(t){if(t)if(e.hasScriptError)e.$message({message:e.hasScriptError,type:"error"});else{var a={interface_type:1,project:e.projectId,intermodule:e.moduleId,name:e.form.name,desc:e.form.desc,request_protocol:e.form.request_protocol,template_server:e.form.template_server,template_port:e.form.template_port,request_way:e.form.request_way,path_url:e.form.path_url,bodyformat:e.form.bodyformat,bodymessageformat:e.form.bodymessageformat,params:e.paramsListData,headerparams:e.headerListData,bodyparams:e.getBodyParams(e.form.bodyformat),preprocessing:e.prependScriptCompile,postprocessing:e.appendScriptCompile,assertion:e.assertScriptCompile,variable:e.extractScriptCompile};e.isEditParams?e.$emit("submit",e.needsDiffData?e.getDiffData(a):a):e.isEdit?e.updateInterface(a):e.saveInterface(a)}}))},saveInterface:function(e){var t=this;Object(L["a"])(e).then((function(e){t.$message({type:"success",message:"新建接口成功"}),t.$router.go(-1)}))},updateInterface:function(e){var t=this,a=Object(n["a"])({},this.getDiffData(e),{project:this.projectId,intermodule:this.interface.intermodule,interface_type:1});Object(L["p"])({id:this.interface.id},a).then((function(e){t.$message({type:"success",message:"更新接口成功"}),t.$router.go(-1)}))},getParams:function(e){var t=[];return e.forEach((function(e){var a=e.key,r=e.value,i=e.desc;a&&t.push({paramname:a,variable_name:r,desc:i})})),t},getBodyParams:function(e){if(3===e)return this.bodyRawJsonObject},getDiffData:function(e){var t=this,a={},r=function(e,t){return JSON.stringify(e)!==JSON.stringify(t)};return Object.keys(this.originFormData).forEach((function(i){r(e[i],t.originFormData[i])&&(a[i]=e[i])})),Object.keys(this.originParamData).forEach((function(i){r(e[i],t.originParamData[i])&&(a[i]=e[i])})),console.log("diff Data:",e,this.originFormData,this.originParamData),console.log("diff Result: ",a),a}}},W=M,H=(a("fda3"),Object(v["a"])(W,r,i,!1,null,"11e03c85",null));t["default"]=H.exports},2226:function(e,t,a){"use strict";a.d(t,"j",(function(){return i})),a.d(t,"b",(function(){return n})),a.d(t,"q",(function(){return s})),a.d(t,"e",(function(){return o})),a.d(t,"m",(function(){return l})),a.d(t,"l",(function(){return c})),a.d(t,"a",(function(){return d})),a.d(t,"p",(function(){return u})),a.d(t,"d",(function(){return p})),a.d(t,"i",(function(){return m})),a.d(t,"k",(function(){return f})),a.d(t,"f",(function(){return v})),a.d(t,"n",(function(){return h})),a.d(t,"g",(function(){return b})),a.d(t,"o",(function(){return y})),a.d(t,"c",(function(){return g})),a.d(t,"h",(function(){return _}));var r=a("b775");function i(e){return Object(r["a"])({url:"/interfacemanagement/modules/",method:"get",params:e})}function n(e){return Object(r["a"])({url:"/interfacemanagement/modules/",method:"post",data:e})}function s(e,t){return Object(r["a"])({url:"/interfacemanagement/modules/".concat(e.id,"/"),method:"put",data:t})}function o(e,t){return Object(r["a"])({url:"/interfacemanagement/modules/".concat(e.id,"/"),method:"delete",data:t})}function l(e){return Object(r["a"])({url:"/interfacemanagement/interfaces/",method:"get",params:e})}function c(e){return Object(r["a"])({url:"/interfacemanagement/interfaces/".concat(e.id,"/"),method:"get"})}function d(e){return Object(r["a"])({url:"/interfacemanagement/interfaces/",method:"post",data:e})}function u(e,t){return Object(r["a"])({url:"/interfacemanagement/interfaces/".concat(e.id,"/"),method:"put",data:t})}function p(e){return Object(r["a"])({url:"/interfacemanagement/interfaces/",method:"delete",data:e})}function m(){return Object(r["a"])({url:"/interfacemanagement/keys/",method:"get"})}function f(e,t){return Object(r["a"])({url:"/interfacemanagement/interfaces/case/".concat(e.id,"/"),method:"get",params:t})}function v(e){return Object(r["a"])({url:"/interfacemanagement/interfaces/execute/",method:"post",data:e})}function h(e){return Object(r["a"])({url:"/interfacemanagement/interfaces/end/",method:"post",data:e})}function b(e){return Object(r["a"])({url:"/interfacemanagement/execute/result/".concat(e.id,"/"),method:"get"})}function y(e){return Object(r["a"])({url:"interfacemanagement/interfaces/accessories/",method:"post",data:e})}function g(e){return Object(r["a"])({url:"/interfacemanagement/interfaces/accessories/",method:"delete",data:e})}function _(e){return Object(r["a"])({url:"/interfacemanagement/interfaces/accessories/",method:"get",params:e})}},6400:function(e,t,a){},"8b4c":function(e,t,a){},d53bd:function(e,t,a){},d578:function(e,t,a){},e658:function(e,t,a){"use strict";var r=a("d53bd"),i=a.n(r);i.a},f15a:function(e,t,a){"use strict";var r=a("d578"),i=a.n(r);i.a},fda3:function(e,t,a){"use strict";var r=a("8b4c"),i=a.n(r);i.a}}]);