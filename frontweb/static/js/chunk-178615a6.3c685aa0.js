(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-178615a6","chunk-0e761762"],{2226:function(e,t,a){"use strict";a.d(t,"j",(function(){return i})),a.d(t,"b",(function(){return s})),a.d(t,"q",(function(){return r})),a.d(t,"e",(function(){return l})),a.d(t,"m",(function(){return o})),a.d(t,"l",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"p",(function(){return d})),a.d(t,"d",(function(){return f})),a.d(t,"i",(function(){return m})),a.d(t,"k",(function(){return p})),a.d(t,"f",(function(){return h})),a.d(t,"n",(function(){return b})),a.d(t,"g",(function(){return v})),a.d(t,"o",(function(){return g})),a.d(t,"c",(function(){return _})),a.d(t,"h",(function(){return y}));var n=a("b775");function i(e){return Object(n["a"])({url:"/interfacemanagement/modules/",method:"get",params:e})}function s(e){return Object(n["a"])({url:"/interfacemanagement/modules/",method:"post",data:e})}function r(e,t){return Object(n["a"])({url:"/interfacemanagement/modules/".concat(e.id,"/"),method:"put",data:t})}function l(e,t){return Object(n["a"])({url:"/interfacemanagement/modules/".concat(e.id,"/"),method:"delete",data:t})}function o(e){return Object(n["a"])({url:"/interfacemanagement/interfaces/",method:"get",params:e})}function c(e){return Object(n["a"])({url:"/interfacemanagement/interfaces/".concat(e.id,"/"),method:"get"})}function u(e){return Object(n["a"])({url:"/interfacemanagement/interfaces/",method:"post",data:e})}function d(e,t){return Object(n["a"])({url:"/interfacemanagement/interfaces/".concat(e.id,"/"),method:"put",data:t})}function f(e){return Object(n["a"])({url:"/interfacemanagement/interfaces/",method:"delete",data:e})}function m(){return Object(n["a"])({url:"/interfacemanagement/keys/",method:"get"})}function p(e,t){return Object(n["a"])({url:"/interfacemanagement/interfaces/case/".concat(e.id,"/"),method:"get",params:t})}function h(e){return Object(n["a"])({url:"/interfacemanagement/interfaces/execute/",method:"post",data:e})}function b(e){return Object(n["a"])({url:"/interfacemanagement/interfaces/end/",method:"post",data:e})}function v(e){return Object(n["a"])({url:"/interfacemanagement/execute/result/".concat(e.id,"/"),method:"get"})}function g(e){return Object(n["a"])({url:"interfacemanagement/interfaces/accessories/",method:"post",data:e})}function _(e){return Object(n["a"])({url:"/interfacemanagement/interfaces/accessories/",method:"delete",data:e})}function y(e){return Object(n["a"])({url:"/interfacemanagement/interfaces/accessories/",method:"get",params:e})}},5564:function(e,t,a){},"5c9d":function(e,t,a){"use strict";var n=a("5564"),i=a.n(n);i.a},"6bb1":function(e,t,a){"use strict";var n=a("9d09"),i=a.n(n);i.a},"8f09":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"excution-result-container"},[a("div",{staticClass:"result-title"},[e._v("\n    测试结果-单接口\n  ")]),e._v(" "),a("div",{staticClass:"result-subtitle"},[e._v("\n    接口/业务名称："+e._s(e.interfaceName)+"\n  ")]),e._v(" "),e.caseResultList.length?a("div",{staticClass:"result-content"},[a("div",{staticClass:"left"},[a("div",{staticClass:"case-item disabled"},[e._v("用例名称")]),e._v(" "),e._l(e.caseResultList,(function(t){return a("div",{key:t.name,staticClass:"case-item",class:{active:e.caseSelected===t},on:{click:function(a){e.caseSelected=t}}},[a("span",{staticClass:"left"},["Fail"===t.status?a("svg-icon",{attrs:{"icon-class":"failed"}}):a("svg-icon",{attrs:{"icon-class":"success"}})],1),e._v(" "),a("span",[e._v(e._s(t.name))]),e._v(" "),a("span",{staticClass:"right"})])}))],2),e._v(" "),a("div",{staticClass:"right"},[a("el-tabs",{attrs:{type:"card"},model:{value:e.activeTabName,callback:function(t){e.activeTabName=t},expression:"activeTabName"}},[a("el-tab-pane",{attrs:{label:"返回结果",name:"response"}},[a("div",{staticClass:"pre-container"},[e.caseSelected?a("pre",[e._v(e._s(e.caseSelected.response_info))]):e._e()])]),e._v(" "),a("el-tab-pane",{attrs:{label:"请求信息",name:"request"}},[a("div",{staticClass:"pre-container"},[e.caseSelected?a("pre",[e._v(e._s(e.caseSelected.request_info))]):e._e()])]),e._v(" "),a("el-tab-pane",{attrs:{label:"断言结果",name:"assert"}},[a("div",{staticClass:"pre-container"},[e.caseSelected?a("pre",[e._v(e._s(e.caseSelected.assert_info))]):e._e()])])],1)],1)]):a("div",{staticClass:"result-pending"},[e._v("\n    --- 该接口暂无执行结果,请等待 ---\n  ")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleCancel}},[e._v("返回")])],1)])},i=[],s=(a("7f7f"),a("2226")),r={data:function(){return{activeTabName:"response",caseSelected:null,loading:!1,caseResultList:[]}},computed:{interfaceId:function(){return this.$route.params.id},interfaceName:function(){return this.$route.params.name}},created:function(){var e=this;this.loading=!0,this.getResult().then((function(t){e.caseResultList=t,e.caseResultList.length&&(e.caseSelected=e.caseResultList[0])})).finally((function(t){e.loading=!1}))},methods:{getResult:function(){var e=this;return new Promise((function(t,a){Object(s["g"])({id:e.interfaceId}).then((function(e){var n=e.data.tip;"DoesNotExist"===n?t([]):e.data.result&&e.data.result.result_info?t(e.data.result.result_info):a(new Error("执行结果数据错误"))}))}))},handleCancel:function(){this.$router.go(-1)}}},l=r,o=(a("6bb1"),a("2877")),c=Object(o["a"])(l,n,i,!1,null,"16eed1dc",null);t["default"]=c.exports},"9d09":function(e,t,a){},"9fbe":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"interface-list-container"},[e.showSearch?a("div",{staticClass:"interface-search"},[a("AppSearch",{staticClass:"interface-search-input",on:{query:e.refreshInterfaceList},model:{value:e.filterForm.name,callback:function(t){e.$set(e.filterForm,"name",t)},expression:"filterForm.name"}}),e._v(" "),a("svg-icon",{staticClass:"interface-search-filter",attrs:{"icon-class":"filter"},on:{click:e.showFilterDialog}})],1):e._e(),e._v(" "),a("div",{staticClass:"interface-main"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"interfaceList",class:e.tableClassCombined,attrs:{fit:"","highlight-current-row":"","element-loading-text":"Loading",data:e.list,height:e.tableHeight},on:{"selection-change":e.handleSelectionChange}},[e.showSelection?a("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"编号",width:"95"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.id)+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.name)+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e._f("interfaceType")(t.row.interface_type))+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"描述",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.desc))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"步骤",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.step)+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"created_at",label:"创建时间",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("parseToDate")(t.row.created)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"修改人",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.modifier))])]}}])}),e._v(" "),e.showOperation?a("el-table-column",{attrs:{label:"操作",width:"330",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{staticClass:"operation-button-group"},[a("span",{on:{click:function(a){return e.editInterface(t.row)}}},[e._v("编辑")]),e._v(" "),a("span",{on:{click:function(a){return e.bindData(t.row)}}},[e._v("绑定数据")]),e._v(" "),1===t.row.status?[a("span",{on:{click:function(a){return e.runInterface(t.row)}}},[e._v("运行")])]:2===t.row.status?[a("span",{on:{click:function(a){return e.terminateInterface(t.row)}}},[e._v("停止")]),e._v(" "),a("span",{on:{click:function(a){return e.checkResult(t.row)}}},[e._v("查看结果")])]:3===t.row.status?[a("span",{on:{click:function(a){return e.runInterface(t.row)}}},[e._v("运行")]),e._v(" "),a("span",{on:{click:function(a){return e.checkResult(t.row)}}},[e._v("查看结果")])]:e._e()],2)}}],null,!1,850863958)}):e._e()],1),e._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:e.getInterfaceList}})],1),e._v(" "),a("FilterDialog",{attrs:{visible:e.filterDialogVisible,"default-data":e.filterForm,"static-data":e.appendParams},on:{"update:visible":function(t){e.filterDialogVisible=t},selected:e.handleFilterSelected}}),e._v(" "),e.showOperation?a("el-dialog",{attrs:{title:"上传数据源",visible:e.addDataVisible,width:"40%","append-to-body":"","before-close":e.handleCancelUpload}},[a("el-form",[a("el-form-item",{attrs:{label:"数据源文件名","label-width":"100px"}},[a("el-input",{model:{value:e.addForm.fileName,callback:function(t){e.$set(e.addForm,"fileName",t)},expression:"addForm.fileName"}})],1)],1),e._v(" "),e.bindDataInterface?a("FileUpload",{ref:"uploadDatasource",attrs:{name:"file_name",action:e.baseUrl+"/datasource/sources/",data:{title:e.addForm.fileName,project:e.bindDataInterface.project},"on-success":e.handleUploadSuccess,"on-error":e.handleUploadError},model:{value:e.addForm.datasourceFile,callback:function(t){e.$set(e.addForm,"datasourceFile",t)},expression:"addForm.datasourceFile"}}):e._e(),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"app-btn-green",on:{click:e.handleChooseExisted}},[e._v("选择已有数据源")]),e._v(" "),a("el-button",{on:{click:e.handleCancelUpload}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirmUpload}},[e._v("确 定")])],1)],1):e._e(),e._v(" "),e.currInterface&&e.caseResultList?a("ExcutionResult",{attrs:{visible:e.excutionResultVisible,"interface-obj":e.currInterface,"case-result-list":e.caseResultList},on:{"update:visible":function(t){e.excutionResultVisible=t}}}):e._e(),e._v(" "),e.showOperation?a("el-dialog",{attrs:{title:"选择已有数据源",visible:e.datasourceListVisible,width:"80%","append-to-body":"","before-close":e.handleCancelChoose}},[a("DatasourceList",{ref:"datasourceList",attrs:{"table-height":"calc(100vh - 25vw)","show-selection":"","show-operation":!1,"single-select":"","append-params":{project:e.projectId}}}),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleCancelChoose}},[e._v("取 消")]),e._v(" "),a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.chooseLoading,expression:"chooseLoading"}],attrs:{disabled:e.chooseLoading,type:"primary"},on:{click:e.handleConfirmChoose}},[e._v("确 定")])],1)],1):e._e()],1)},i=[],s=a("768b"),r=(a("7f7f"),a("75fc")),l=a("db72"),o=a("2226"),c=a("b964"),u=a("2a75"),d=a("5ac2"),f=a("333d"),m=a("a5dd"),p=a("8f09"),h="http://47.103.26.195:8080",b={name:"InterfaceList",components:{AppSearch:d["a"],Pagination:f["a"],FilterDialog:m["a"],FileUpload:u["a"],ExcutionResult:p["default"],DatasourceList:function(){return a.e("chunk-33290a4f").then(a.bind(null,"4080"))}},props:{appendParams:{type:Object,default:function(){return{}}},tableHeight:{type:String,default:"auto"},tableClass:{type:[String,Array],default:""},showSelection:{type:Boolean,default:!1},showOperation:{type:Boolean,default:!0},showSearch:{type:Boolean,default:!1},singleSelect:{type:Boolean,default:!1}},data:function(){return{list:null,total:0,listLoading:!1,listQuery:{page:1,limit:20},filterDialogVisible:!1,filterForm:{name:"",interface_type:"",status:""},currInterface:null,addDataVisible:!1,addForm:{fileName:"",datasourceFile:[]},baseUrl:h,bindDataInterface:null,serverList:null,excelList:null,serverListCache:{},runInterfaceVisible:!1,excutionResultVisible:!1,caseResultList:[],datasourceListVisible:!1,chooseLoading:!1}},computed:{appendParamsCombined:function(){return Object(l["a"])({},this.filterForm,{},this.appendParams)},tableClassCombined:function(){var e;return e="string"===typeof this.tableClass?[this.tableClass]:this.tableClass,[].concat(Object(r["a"])(e),[this.singleSelect?"app-single-select-table":""])},projectId:function(){return this.$store.getters.selectedProjectId}},created:function(){this.getInterfaceList()},methods:{getInterfaceList:function(){var e=this;this.listLoading=!0,Object(o["m"])(Object(l["a"])({page:this.listQuery.page,page_size:this.listQuery.limit},this.appendParamsCombined)).then((function(t){e.list=t.data.results,e.total=t.data.count,e.listLoading=!1}))},refreshInterfaceList:function(){this.listQuery.page=1,this.getInterfaceList()},getSelection:function(){return this.$refs.interfaceList.selection},showFilterDialog:function(){this.filterDialogVisible=!0},handleFilterSelected:function(e){var t=this;this.filterForm.interface_type=e.interface_type,this.filterForm.status=e.status,this.$nextTick((function(e){t.refreshInterfaceList()}))},editInterface:function(e){1===e.interface_type?this.$router.push({name:"InterfaceEdit",params:{projectId:e.project,interfaceId:e.id,interface:e}}):2===e.interface_type&&this.$router.push({name:"BusinessEdit",params:{projectId:e.project,interfaceId:e.id,interface:e}})},runInterface:function(e){this.$router.push({name:"InterfaceExcute",params:{interfaceObj:e}})},terminateInterface:function(e){var t=this;this.$confirm("确认停止接口运行？").then((function(a){t.listLoading=!0,Object(o["n"])({interfaceid:[e.id]}).then((function(e){t.$message({message:"已停止接口运行",type:"success"}),t.getInterfaceList()})).catch((function(e){t.$message({message:e.data.tip||e.message,type:"error"})})).finally((function(e){t.listLoading=!1}))})).catch((function(e){}))},bindData:function(e){if(e.source_title){var t=e.source_title;this.addForm.fileName=t,this.addForm.datasourceFile=[{name:t}]}else this.addForm.fileName="",this.addForm.datasourceFile=[];this.addDataVisible=!0,this.bindDataInterface=e},checkResult:function(e){this.$router.push({name:"InterfaceExcuteResult",params:{id:e.id,name:e.name}})},handleUploadSuccess:function(e){var t=this,a=e.data,n=a.id;n?Object(c["c"])({id:n},{interface:this.bindDataInterface.id}).then((function(e){t.addDataVisible=!1,t.$message({type:"success",message:"绑定成功"})})):this.$message({type:"error",message:"上传失败"})},handleUploadError:function(e){this.$message({type:"error",message:e.message})},handleChooseExisted:function(){this.datasourceListVisible=!0},handleCancelUpload:function(){this.addDataVisible=!1},handleConfirmUpload:function(){this.addForm.fileName?this.bindDataInterface&&this.bindDataInterface.project?this.$refs.uploadDatasource.fileList.length?this.$refs.uploadDatasource.submit():this.$message({message:"请上传文件",type:"error"}):this.$message({message:"数据不全",type:"error"}):this.$message({message:"请输入文件名",type:"error"})},handleSelectionChange:function(e){if(this.singleSelect&&e.length>1){var t=e.pop();this.$refs.interfaceList.clearSelection(),this.$refs.interfaceList.toggleRowSelection(t,!0)}this.$emit("selection-change",e)},handleCancelChoose:function(){this.datasourceListVisible=!1},handleConfirmChoose:function(){var e=this,t=this.$refs.datasourceList.getSelection(),a=Object(s["a"])(t,1),n=a[0],i=n.id;this.chooseLoading=!0,Object(c["c"])({id:i},{interface:this.bindDataInterface.id}).then((function(t){e.addDataVisible=!1,e.datasourceListVisible=!1,e.getInterfaceList(),e.$message({type:"success",message:"绑定成功"})})).finally((function(t){e.chooseLoading=!1}))},clearSelection:function(){this.$refs.interfaceList.clearSelection()}}},v=b,g=(a("5c9d"),a("2877")),_=Object(g["a"])(v,n,i,!1,null,"3e8d7fa6",null);t["default"]=_.exports},a5dd:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"筛选条件",visible:e.visible,width:"20%","append-to-body":"","before-close":e.handleCancel}},[a("el-form",{attrs:{"label-width":"80px",model:e.form}},[a("el-form-item",{attrs:{label:"类型"}},[a("el-select",{attrs:{disabled:e.isStaticData("interface_type")},model:{value:e.form.interface_type,callback:function(t){e.$set(e.form,"interface_type",t)},expression:"form.interface_type"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),a("el-option",{attrs:{label:"接口",value:1}}),e._v(" "),a("el-option",{attrs:{label:"流程",value:2}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"运行状态",disabled:e.isStaticData("status")}},[a("el-select",{model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),a("el-option",{attrs:{label:"未运行",value:1}}),e._v(" "),a("el-option",{attrs:{label:"运行中",value:2}}),e._v(" "),a("el-option",{attrs:{label:"运行完成",value:3}})],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleCancel}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirm}},[e._v("确 定")])],1)],1)},i=[],s={props:{visible:{type:Boolean,default:!1},defaultData:{type:Object,default:function(){return{}}},staticData:{type:Object,default:function(){return{}}}},data:function(){return{form:{interface_type:"",status:""}}},watch:{defaultData:{handler:function(e){for(var t in e)this.form[t]=e[t]},immediate:!0},staticData:{handler:function(e){for(var t in e)this.form[t]=e[t]},immediate:!0}},methods:{isStaticData:function(e){return e in this.staticData},handleCancel:function(){this.$emit("update:visible",!1)},handleConfirm:function(){this.$emit("selected",this.form),this.$emit("update:visible",!1)}}},r=s,l=a("2877"),o=Object(l["a"])(r,n,i,!1,null,null,null);t["a"]=o.exports}}]);