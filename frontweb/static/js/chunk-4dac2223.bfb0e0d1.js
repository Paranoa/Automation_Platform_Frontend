(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4dac2223"],{"04bb":function(t,e,n){},"0625":function(t,e,n){"use strict";var i=n("11ae"),a=n.n(i);a.a},"09f4":function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),Math.easeInOutQuad=function(t,e,n,i){return t/=i/2,t<1?n/2*t*t+e:(t--,-n/2*(t*(t-2)-1)+e)};var i=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function a(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}function r(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function o(t,e,n){var o=r(),s=t-o,l=20,c=0;e="undefined"===typeof e?500:e;var u=function t(){c+=l;var r=Math.easeInOutQuad(c,o,s,e);a(r),c<e?i(t):n&&"function"===typeof n&&n()};u()}},"11ae":function(t,e,n){},"11e9":function(t,e,n){var i=n("52a7"),a=n("4630"),r=n("6821"),o=n("6a99"),s=n("69a8"),l=n("c69a"),c=Object.getOwnPropertyDescriptor;e.f=n("9e1e")?c:function(t,e){if(t=r(t),e=o(e,!0),l)try{return c(t,e)}catch(n){}if(s(t,e))return a(!i.f.call(t,e),t[e])}},"3e55":function(t,e,n){"use strict";var i=n("408b"),a=n.n(i);a.a},"408b":function(t,e,n){},"5dbc":function(t,e,n){var i=n("d3f4"),a=n("8b97").set;t.exports=function(t,e,n){var r,o=e.constructor;return o!==n&&"function"==typeof o&&(r=o.prototype)!==n.prototype&&i(r)&&a&&a(t,r),t}},"707c":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Navbar"),t._v(" "),n("div",{staticClass:"project-container"},[n("ProjectList",{ref:"projectList",attrs:{"table-height":"calc(100vh - 21.35vw)","show-selection":""}},[n("template",{slot:"tableHead"},[n("div",{staticClass:"button-group"},[n("el-button",{staticClass:"app-el-btn-primary",attrs:{size:"small",plain:""},on:{click:t.addProject,finished:t.refreshProjectList}},[t._v("新建项目")]),t._v(" "),n("el-button",{staticClass:"app-el-btn-primary",attrs:{size:"small",plain:""}},[t._v("复制")]),t._v(" "),n("el-button",{staticClass:"app-el-btn-primary",attrs:{size:"small",plain:""},on:{click:t.deleteProjects}},[t._v("删除")]),t._v(" "),n("el-button",{staticClass:"app-el-btn-primary",attrs:{size:"small",plain:""},on:{click:function(e){return t.changeState(!1)}}},[t._v("停用")]),t._v(" "),n("el-button",{staticClass:"app-el-btn-primary",attrs:{size:"small",plain:""},on:{click:function(e){return t.changeState(!0)}}},[t._v("启用")])],1)])],2)],1)],1)},a=[],r=n("cd4a"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"project-list-container"},[n("div",{staticClass:"project-search"},[n("AppSearch",{staticClass:"project-search-input",on:{query:t.handleFilterConfirmed},model:{value:t.filterForm.name,callback:function(e){t.$set(t.filterForm,"name",e)},expression:"filterForm.name"}}),t._v(" "),n("svg-icon",{staticClass:"project-search-filter",attrs:{"icon-class":"filter"},on:{click:t.showFilterDialog}})],1),t._v(" "),n("div",{staticClass:"project-tools"},[t._t("tableHead")],2),t._v(" "),n("div",{staticClass:"project-main"},[n("div",{staticClass:"title"},[t._v("项目列表")]),t._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"projectList",staticClass:"app-list-table",attrs:{data:t.list,"element-loading-text":"Loading",fit:"","highlight-current-row":"",height:t.tableHeight}},[t.showSelection?n("el-table-column",{attrs:{type:"selection",width:"55"}}):t._e(),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"项目编号",width:"95"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.id)+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"项目名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.name)+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"项目优先级",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(t._f("projectLevel")(e.row.level)))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"项目时间",width:"400",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(t._f("parseToDate")(e.row.start_time))+" - "+t._s(t._f("parseToDate")(e.row.end_time))+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",prop:"created_at",label:"状态",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.status?"启用":"停用"))])]}}])}),t._v(" "),t.showOperation?n("el-table-column",{attrs:{label:"操作",width:"250",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"operation-button-group"},[n("span",{on:{click:function(n){return t.editTemplate(e.row)}}},[t._v("模板")]),t._v(" "),n("span",{on:{click:function(n){return t.editProject(e.row)}}},[t._v("编辑")]),t._v(" "),n("span",{on:{click:function(n){return t.enviromentManage(e.row)}}},[t._v("环境")]),t._v(" "),n("span",{on:{click:function(n){return t.userManage(e.row)}}},[t._v("人员")])])]}}],null,!1,1139992702)}):t._e()],1),t._v(" "),n("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.listQuery.page,limit:t.listQuery.limit},on:{"update:page":function(e){return t.$set(t.listQuery,"page",e)},"update:limit":function(e){return t.$set(t.listQuery,"limit",e)},pagination:t.getProjectList}}),t._v(" "),n("FilterDialog",{attrs:{visible:t.filterDialogVisible,"default-data":t.filterForm},on:{"update:visible":function(e){t.filterDialogVisible=e},selected:t.handleFilterSelected}}),t._v(" "),t.selectedProject?n("EnvironmentManage",{attrs:{project:t.selectedProject,visible:t.environmentManageVisible},on:{"update:visible":function(e){t.environmentManageVisible=e}}}):t._e(),t._v(" "),t.selectedProject?n("UserManage",{attrs:{project:t.selectedProject,visible:t.userManageVisible},on:{"update:visible":function(e){t.userManageVisible=e}}}):t._e()],1)])},s=[],l=n("db72"),c=n("24d2"),u=n("5ac2"),f=n("333d"),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{title:"筛选条件",visible:t.visible,width:"400px","append-to-body":"","before-close":t.handleCancel}},[n("el-form",{attrs:{"label-width":"120px",model:t.form}},[n("el-form-item",{attrs:{label:"项目优先级"}},[n("el-select",{model:{value:t.form.level,callback:function(e){t.$set(t.form,"level",e)},expression:"form.level"}},[n("el-option",{attrs:{label:"全部",value:""}}),t._v(" "),n("el-option",{attrs:{label:"高",value:3}}),t._v(" "),n("el-option",{attrs:{label:"中",value:2}}),t._v(" "),n("el-option",{attrs:{label:"低",value:1}})],1)],1),t._v(" "),n("el-form-item",{attrs:{label:"项目状态"}},[n("el-select",{model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[n("el-option",{attrs:{label:"全部",value:""}}),t._v(" "),n("el-option",{attrs:{label:"启用",value:!0}}),t._v(" "),n("el-option",{attrs:{label:"停用",value:!1}})],1)],1)],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("span",{staticClass:"app-btn app-btn-blue",attrs:{type:"primary"},on:{click:t.handleConfirm}},[t._v("确 定")]),t._v(" "),n("span",{staticClass:"app-btn app-btn-white",on:{click:t.handleCancel}},[t._v("返 回")])])],1)},d=[],m={props:{visible:{type:Boolean,default:!1},defaultData:{type:Object,default:function(){return{}}}},data:function(){return{form:{level:null,status:null}}},watch:{defaultData:{handler:function(t){for(var e in t)this.form[e]=t[e]},immediate:!0}},methods:{handleCancel:function(){this.$emit("update:visible",!1)},handleConfirm:function(){this.$emit("selected",this.form),this.$emit("update:visible",!1)}}},h=m,v=(n("3e55"),n("2877")),b=Object(v["a"])(h,p,d,!1,null,"57ac6274",null),g=b.exports,_=function(){return n.e("chunk-0dddbc0a").then(n.bind(null,"cd6e"))},j=function(){return n.e("chunk-7db0bba7").then(n.bind(null,"d825"))},y={components:{AppSearch:u["a"],Pagination:f["a"],FilterDialog:g,EnvironmentManage:_,UserManage:j},props:{tableHeight:{type:String,default:"auto"},showSelection:{type:Boolean,default:!1},showSearch:{type:Boolean,default:!0},showOperation:{type:Boolean,default:!0}},data:function(){return{list:null,total:0,listLoading:!0,listQuery:{page:1,limit:10},filterDialogVisible:!1,filterForm:{level:null,status:null},filterFormConfirmed:{},selectedProject:!1,environmentManageVisible:!1,userManageVisible:!1}},computed:{appendParams:function(){return Object(l["a"])({},this.filterFormConfirmed)}},created:function(){this.getProjectList()},methods:{getProjectList:function(){var t=this;this.listLoading=!0,Object(c["i"])(Object(l["a"])({page:this.listQuery.page,page_size:this.listQuery.limit},this.appendParams)).then((function(e){t.list=e.data.results,t.total=e.data.count,t.listLoading=!1}))},refreshProjectList:function(){this.listQuery.page=1,this.getProjectList()},showFilterDialog:function(){this.filterDialogVisible=!0},handleFilterSelected:function(t){var e=this;this.filterForm=Object(l["a"])({},this.filterForm,{},t),this.confirmFilterForm(),this.$nextTick((function(t){return e.refreshProjectList()}))},editTemplate:function(t){this.$router.push({name:"projectTemplateEdit",params:{id:t.id}})},editProject:function(t){this.$router.push({name:"projectEdit",params:{project:t}})},enviromentManage:function(t){this.$router.push({name:"projectEnv",params:{id:t.id}})},userManage:function(t){this.$router.push({name:"projectUsers",params:{project:t}}),this.selectedProject=t,this.userManageVisible=!0},getSelection:function(){return this.$refs.projectList.selection},handleFilterConfirmed:function(){var t=this;this.confirmFilterForm(),this.$nextTick((function(e){return t.refreshProjectList()}))},confirmFilterForm:function(){this.filterFormConfirmed=Object(l["a"])({},this.filterForm)}}},w=y,P=(n("0625"),Object(v["a"])(w,o,s,!1,null,"3b1b343a",null)),F=P.exports,C={name:"Project",components:{ProjectList:F,Navbar:r["b"]},data:function(){return{form:{query:""}}},mounted:function(){this.projects=this.$refs.projectList},activated:function(){this.needsRefresh&&this.refreshProjectList()},deactivated:function(){this.needsRefresh=!0},methods:{changeState:function(t){var e=this,n=this.projects.getSelection();if(n&&n.length){var i=n.map((function(t){var e=t.id;return e}));Object(c["m"])({ids:i,status:t}).then((function(t){e.$message({type:"success",message:"更新成功"}),e.refreshProjectList()}))}},addProject:function(){this.$router.push("/project/add")},deleteProjects:function(){var t=this,e=this.projects.getSelection();e&&e.length&&this.$confirm("将删除项目, 是否继续?","提示").then((function(n){var i=e.map((function(t){var e=t.id;return e}));Object(c["f"])({ids:i}).then((function(e){t.$message({type:"success",message:"删除成功"}),t.refreshProjectList(),t.$store.dispatch("user/getAllProjects")})).catch((function(e){t.$message({message:"删除失败，项目有其他关联",type:"error"})}))}))},refreshProjectList:function(){this.projects.getProjectList()}}},k=C,L=(n("d24a"),Object(v["a"])(k,i,a,!1,null,"3c0d0db7",null));e["default"]=L.exports},"8b97":function(t,e,n){var i=n("d3f4"),a=n("cb7c"),r=function(t,e){if(a(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{i=n("9b43")(Function.call,n("11e9").f(Object.prototype,"__proto__").set,2),i(t,[]),e=!(t instanceof Array)}catch(a){e=!0}return function(t,n){return r(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:r}},9093:function(t,e,n){var i=n("ce10"),a=n("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,a)}},aa77:function(t,e,n){var i=n("5ca1"),a=n("be13"),r=n("79e5"),o=n("fdef"),s="["+o+"]",l="​",c=RegExp("^"+s+s+"*"),u=RegExp(s+s+"*$"),f=function(t,e,n){var a={},s=r((function(){return!!o[t]()||l[t]()!=l})),c=a[t]=s?e(p):o[t];n&&(a[n]=c),i(i.P+i.F*s,"String",a)},p=f.trim=function(t,e){return t=String(a(t)),1&e&&(t=t.replace(c,"")),2&e&&(t=t.replace(u,"")),t};t.exports=f},c5f6:function(t,e,n){"use strict";var i=n("7726"),a=n("69a8"),r=n("2d95"),o=n("5dbc"),s=n("6a99"),l=n("79e5"),c=n("9093").f,u=n("11e9").f,f=n("86cc").f,p=n("aa77").trim,d="Number",m=i[d],h=m,v=m.prototype,b=r(n("2aeb")(v))==d,g="trim"in String.prototype,_=function(t){var e=s(t,!1);if("string"==typeof e&&e.length>2){e=g?e.trim():p(e,3);var n,i,a,r=e.charCodeAt(0);if(43===r||45===r){if(n=e.charCodeAt(2),88===n||120===n)return NaN}else if(48===r){switch(e.charCodeAt(1)){case 66:case 98:i=2,a=49;break;case 79:case 111:i=8,a=55;break;default:return+e}for(var o,l=e.slice(2),c=0,u=l.length;c<u;c++)if(o=l.charCodeAt(c),o<48||o>a)return NaN;return parseInt(l,i)}}return+e};if(!m(" 0o1")||!m("0b1")||m("+0x1")){m=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof m&&(b?l((function(){v.valueOf.call(n)})):r(n)!=d)?o(new h(_(e)),n,m):_(e)};for(var j,y=n("9e1e")?c(h):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),w=0;y.length>w;w++)a(h,j=y[w])&&!a(m,j)&&f(m,j,u(h,j));m.prototype=v,v.constructor=m,n("2aba")(i,d,m)}},d24a:function(t,e,n){"use strict";var i=n("04bb"),a=n.n(i);a.a},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);