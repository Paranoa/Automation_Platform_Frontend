(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-49ef870a","chunk-33290a4f"],{"09f4":function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),Math.easeInOutQuad=function(e,t,a,i){return e/=i/2,e<1?a/2*e*e+t:(e--,-a/2*(e*(e-2)-1)+t)};var i=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function r(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function n(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function o(e,t,a){var o=n(),s=e-o,c=20,l=0;t="undefined"===typeof t?500:t;var u=function e(){l+=c;var n=Math.easeInOutQuad(l,o,s,t);r(n),l<t?i(e):a&&"function"===typeof a&&a()};u()}},"11e9":function(e,t,a){var i=a("52a7"),r=a("4630"),n=a("6821"),o=a("6a99"),s=a("69a8"),c=a("c69a"),l=Object.getOwnPropertyDescriptor;t.f=a("9e1e")?l:function(e,t){if(e=n(e),t=o(t,!0),c)try{return l(e,t)}catch(a){}if(s(e,t))return r(!i.f.call(e,t),e[t])}},"1af6":function(e,t,a){var i=a("63b6");i(i.S,"Array",{isArray:a("9003")})},"26ef":function(e,t,a){},3953:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var i=a("774e"),r=a.n(i),n=a("c8bb"),o=a.n(n);function s(e){if(o()(Object(e))||"[object Arguments]"===Object.prototype.toString.call(e))return r()(e)}},"404c":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"筛选条件",visible:e.visible,width:"40%","append-to-body":"","before-close":e.handleCancel}},[a("el-form",{attrs:{"label-width":"80px",model:e.form}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"活动区域"}},[a("el-input",{model:{value:e.form.region,callback:function(t){e.$set(e.form,"region",t)},expression:"form.region"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"活动形式"}},[a("el-input",{model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleCancel}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirm}},[e._v("确 定")])],1)],1)},r=[],n={props:{visible:{type:Boolean,default:!1},defaultData:{type:Object,default:function(){return{}}}},data:function(){return{form:{}}},watch:{defaultData:{handler:function(e){for(var t in e)this.form[t]=e[t]},immediate:!0}},methods:{handleCancel:function(){this.$emit("update:visible",!1)},handleConfirm:function(){this.$emit("selected",this.form),this.$emit("update:visible",!1)}}},o=n,s=a("2877"),c=Object(s["a"])(o,i,r,!1,null,null,null);t["a"]=c.exports},4080:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"datasource-list-container"},[e.showSearch?a("div",{staticClass:"datasource-search"},[a("AppSearch",{staticClass:"datasource-search-input",model:{value:e.form.query,callback:function(t){e.$set(e.form,"query",t)},expression:"form.query"}}),e._v(" "),a("svg-icon",{staticClass:"datasource-search-filter",attrs:{"icon-class":"filter"},on:{click:e.showFilterDialog}})],1):e._e(),e._v(" "),a("div",{staticClass:"datasource-main"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"datasourceList",staticClass:"app-list-table",class:e.tableClassCombined,attrs:{data:e.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":"",height:e.tableHeight},on:{"selection-change":e.handleSelectionChange}},[e.showSelection?a("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"文件名"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.title)+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"关联接口/流程"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.interfacename)+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"修改时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e._f("parseToDate")(t.row.updated))+"\n        ")]}}])}),e._v(" "),e.showOperation?a("el-table-column",{attrs:{label:"操作",width:"250",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{staticClass:"operation-button-group"},[a("span",{on:{click:function(a){return e.uploadData(t.row)}}},[e._v("上传")]),e._v(" "),a("span",{on:{click:function(a){return e.downloadData(t.row)}}},[e._v("下载")]),e._v(" "),a("span",{on:{click:function(a){return e.deleteData(t.row)}}},[e._v("删除")]),e._v(" "),a("span",{attrs:{type:"success"},on:{click:function(a){return e.bindData(t.row)}}},[e._v("绑定")])])}}],null,!1,380106861)}):e._e()],1),e._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit},on:{"update:page":function(t){return e.$set(e.listQuery,"page",t)},"update:limit":function(t){return e.$set(e.listQuery,"limit",t)},pagination:e.getDatasourceList}}),e._v(" "),a("FilterDialog",{attrs:{visible:e.filterDialogVisible,"default-data":e.filterForm},on:{"update:visible":function(t){e.filterDialogVisible=t},selected:e.handleFilterSelected}}),e._v(" "),e.showOperation?a("el-dialog",{attrs:{title:"选择绑定接口",visible:e.interfaceVisible,"before-close":function(t){return e.interfaceVisible=!1},"append-to-body":"",width:"80%"}},[a("InterfaceList",{ref:"interfaceList",attrs:{"table-height":"calc(100vh - 25vw)","show-operation":!1,"show-selection":"","single-select":"","table-class":"app-list-table"}}),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.interfaceVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirmChoose}},[e._v("确 定")])],1)],1):e._e()],1)])},r=[],n=a("db72"),o=a("75fc"),s=a("5ac2"),c=a("333d"),l=a("404c"),u=a("b964"),d={name:"DatasourceList",components:{AppSearch:s["a"],Pagination:c["a"],FilterDialog:l["a"],InterfaceList:function(){return Promise.all([a.e("chunk-178615a6"),a.e("chunk-7854879d")]).then(a.bind(null,"9fbe"))}},props:{appendParams:{type:Object,default:function(){return{}}},tableHeight:{type:String,default:"auto"},tableClass:{type:[String,Array],default:""},showSelection:{type:Boolean,default:!1},showSearch:{type:Boolean,default:!1},showOperation:{type:Boolean,default:!0},singleSelect:{type:Boolean,default:!1}},data:function(){return{form:{query:""},list:null,total:0,listLoading:!0,listQuery:{page:1,limit:20},filterDialogVisible:!1,filterForm:{name:"zw"},currDatasource:null,interfaceVisible:!1}},computed:{tableClassCombined:function(){var e;return e="string"===typeof this.tableClass?[this.tableClass]:this.tableClass,[].concat(Object(o["a"])(e),[this.singleSelect?"app-single-select-table":""])}},created:function(){this.getDatasourceList()},methods:{getDatasourceList:function(){var e=this;this.listLoading=!0,Object(u["b"])(Object(n["a"])({page:this.listQuery.page,page_size:this.listQuery.limit},this.appendParams)).then((function(t){e.list=t.data.results,e.total=t.data.count,e.listLoading=!1}))},getSelection:function(){return this.$refs.datasourceList.selection},showFilterDialog:function(){this.filterDialogVisible=!0},handleFilterSelected:function(e){this.filterForm=e},uploadData:function(e){this.$emit("editDatasource",e)},downloadData:function(e){window.open(e.file_name)},deleteData:function(e){var t=this;this.$confirm("将删除数据源, 是否继续?","提示").then((function(a){var i=[e.id];Object(u["a"])({ids:i}).then((function(e){t.$message({type:"success",message:"删除成功"}),t.getDatasourceList()})).catch((function(e){}))}))},bindData:function(e){this.interfaceVisible=!0,this.currDatasource=e},handleConfirmChoose:function(){var e=this,t=this.$refs.interfaceList.getSelection(),a=t[0].id;Object(u["c"])({id:this.currDatasource.id},{interface:a}).then((function(t){e.interfaceVisible=!1,e.$message({type:"success",message:"绑定成功"}),e.$refs.interfaceList.clearSelection()}))},handleSelectionChange:function(e){if(this.singleSelect&&e.length>1){var t=e.pop();this.$refs.datasourceList.clearSelection(),this.$refs.datasourceList.toggleRowSelection(t,!0)}this.$emit("selection-change",e)}}},f=d,p=(a("b95a"),a("2877")),m=Object(p["a"])(f,i,r,!1,null,"f847e5d2",null);t["default"]=m.exports},"42e6":function(e,t,a){},"549b":function(e,t,a){"use strict";var i=a("d864"),r=a("63b6"),n=a("241e"),o=a("b0dc"),s=a("3702"),c=a("b447"),l=a("20fd"),u=a("7cd6");r(r.S+r.F*!a("4ee1")((function(e){Array.from(e)})),"Array",{from:function(e){var t,a,r,d,f=n(e),p="function"==typeof this?this:Array,m=arguments.length,h=m>1?arguments[1]:void 0,b=void 0!==h,v=0,g=u(f);if(b&&(h=i(h,m>2?arguments[2]:void 0,2)),void 0==g||p==Array&&s(g))for(t=c(f.length),a=new p(t);t>v;v++)l(a,v,b?h(f[v],v):f[v]);else for(d=g.call(f),a=new p;!(r=d.next()).done;v++)l(a,v,b?o(d,h,[r.value,v],!0):r.value);return a.length=v,a}})},"54a1":function(e,t,a){a("6c1c"),a("1654"),e.exports=a("95d5")},"5dbc":function(e,t,a){var i=a("d3f4"),r=a("8b97").set;e.exports=function(e,t,a){var n,o=t.constructor;return o!==a&&"function"==typeof o&&(n=o.prototype)!==a.prototype&&i(n)&&r&&r(e,n),e}},6639:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Navbar"),e._v(" "),a("div",{staticClass:"datasource-container"},[a("div",{staticClass:"datasource-search"},[a("AppSearch",{staticClass:"datasource-search-input",on:{query:e.refreshDatasourceList},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}}),e._v(" "),a("el-select",{staticClass:"datasource-search-project",attrs:{size:"mini"},model:{value:e.projectId,callback:function(t){e.projectId=t},expression:"projectId"}},e._l(e.$store.getters.allProjects,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),a("div",{staticClass:"button-group"},[a("el-button",{staticClass:"app-el-btn-primary",attrs:{size:"small",plain:""},on:{click:function(t){e.addDataVisible=!0}}},[e._v("新建\n      ")]),e._v(" "),a("el-button",{staticClass:"app-el-btn-primary",attrs:{size:"small",plain:""}},[e._v("复制\n      ")]),e._v(" "),a("el-button",{staticClass:"app-el-btn-primary",attrs:{size:"small",plain:""}},[e._v("删除\n      ")])],1),e._v(" "),a("DatasourceList",{ref:"datasourceList",staticClass:"datasource-main",attrs:{"table-height":"calc(100vh - 19.2vw)","show-selection":"","append-params":e.appendParams},on:{editDatasource:e.editDatasource}}),e._v(" "),a("el-dialog",{attrs:{title:"上传数据源",visible:e.addDataVisible,width:"40%","before-close":e.handleCancel}},[a("el-form",[a("el-form-item",{attrs:{label:"数据源文件名","label-width":"100px"}},[a("el-input",{model:{value:e.addForm.fileName,callback:function(t){e.$set(e.addForm,"fileName",t)},expression:"addForm.fileName"}})],1)],1),e._v(" "),a("FileUpload",{ref:"uploadDatasource",attrs:{name:"file_name",action:e.baseUrl+"/datasource/sources/",data:{title:e.addForm.fileName,project:e.projectId},"on-success":e.handleUploadSuccess},model:{value:e.addForm.datasourceFile,callback:function(t){e.$set(e.addForm,"datasourceFile",t)},expression:"addForm.datasourceFile"}}),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleCancel}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleAddConfirm}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"上传数据源",visible:e.editDataVisible,width:"40%"}},[a("el-form",[a("el-form-item",{attrs:{label:"数据源文件名","label-width":"100px"}},[a("el-input",{model:{value:e.editForm.fileName,callback:function(t){e.$set(e.editForm,"fileName",t)},expression:"editForm.fileName"}})],1)],1),e._v(" "),e.editForm.datasource?a("FileUpload",{ref:"uploadDatasource2",attrs:{name:"file_name",action:e.baseUrl+"/datasource/sources/"+e.editForm.datasource.id+"/","http-request":e.uploadAction,data:{title:e.editForm.fileName}},model:{value:e.editForm.datasourceFile,callback:function(t){e.$set(e.editForm,"datasourceFile",t)},expression:"editForm.datasourceFile"}}):e._e(),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editDataVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleEditConfirm}},[e._v("确 定")])],1)],1),e._v(" "),e._e()],1)],1)},r=[],n=(a("7f7f"),a("cd4a")),o=a("4080"),s=a("2a75"),c=a("bc3a"),l=a.n(c),u=a("b964"),d=a("5f87"),f=a("5ac2"),p=a("404c"),m="http://47.103.26.195:8080",h={name:"Datasource",components:{DatasourceList:o["default"],FileUpload:s["a"],Navbar:n["b"],AppSearch:f["a"],FilterDialog:p["a"]},data:function(){var e="";return this.$store.getters.allProjects&&(this.$store.getters.selectedProjectId?e=this.$store.getters.selectedProjectId:this.$store.getters.allProjects.length&&(e=this.$store.getters.allProjects[0].id)),{form:{name:""},baseUrl:m,projectId:e,addForm:{fileName:"",datasourceFile:[]},editForm:{datasource:null,fileName:"",datasourceFile:[]},addDataVisible:!1,editDataVisible:!1,filterDialogVisible:!1}},computed:{appendParams:function(){return{project:this.projectId,name:this.form.name}}},watch:{projectId:{handler:function(e,t){var a=this;this.$store.dispatch("user/setSelectedProjectId",e),this.$nextTick((function(e){a.refreshDatasourceList()}))}}},activated:function(){this.needsRefresh&&(this.refreshDatasourceList(),this.refreshSelectedProject())},deactivated:function(){this.needsRefresh=!0},methods:{showFilterDialog:function(){this.filterDialogVisible=!0},handleUploadSuccess:function(){this.addDataVisible=!1,this.$message({type:"success",message:"上传成功"}),this.refreshDatasourceList()},handleCancel:function(){this.addDataVisible=!1},handleAddConfirm:function(){this.addForm.fileName&&this.projectId&&(this.$refs.uploadDatasource.fileList.length?this.$refs.uploadDatasource.submit():this.$message({message:"请上传文件",type:"error"}))},handleEditConfirm:function(){this.editForm.fileName&&(this.$refs.uploadDatasource2.fileList.length?this.$refs.uploadDatasource2.submit():this.$message({message:"请上传文件",type:"error"}))},editDatasource:function(e){this.editDataVisible=!0,this.editForm.datasource=e,this.editForm.fileName=e.title},uploadAction:function(e){var t=this,a=e.data,i=e.action,r=e.file,n=new FormData;for(var o in a)n.append(o,a[o]);n.append("file_name",r);var s={headers:{"Content-Type":"multipart/form-data",AUTHORIZATION:Object(d["b"])()}};l.a.put(i,n,s).then((function(e){var a=e.data;200===a.code?(t.editDataVisible=!1,t.$message({type:"success",message:"上传成功"}),t.refreshDatasourceList()):t.$message({type:"error",message:a.message})}))},deleteDatasources:function(){var e=this,t=this.$refs.datasourceList.getSelection();t&&t.length&&this.$confirm("将删除数据源, 是否继续?","提示").then((function(a){var i=t.map((function(e){var t=e.id;return t}));Object(u["a"])({ids:i}).then((function(t){e.$message({type:"success",message:"删除成功"}),e.refreshDatasourceList()}))})).catch((function(e){}))},refreshDatasourceList:function(){this.$refs.datasourceList.getDatasourceList()},refreshSelectedProject:function(){this.$store.getters.selectedProjectId&&(this.projectId=this.$store.getters.selectedProjectId)}}},b=h,v=(a("9d66"),a("2877")),g=Object(v["a"])(b,i,r,!1,null,"f7c44098",null);t["default"]=g.exports},"75fc":function(e,t,a){"use strict";var i=a("a745"),r=a.n(i);function n(e){if(r()(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}var o=a("3953");function s(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function c(e){return n(e)||Object(o["a"])(e)||s()}a.d(t,"a",(function(){return c}))},"774e":function(e,t,a){e.exports=a("d2d5")},"8b97":function(e,t,a){var i=a("d3f4"),r=a("cb7c"),n=function(e,t){if(r(e),!i(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,i){try{i=a("9b43")(Function.call,a("11e9").f(Object.prototype,"__proto__").set,2),i(e,[]),t=!(e instanceof Array)}catch(r){t=!0}return function(e,a){return n(e,a),t?e.__proto__=a:i(e,a),e}}({},!1):void 0),check:n}},9093:function(e,t,a){var i=a("ce10"),r=a("e11e").concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return i(e,r)}},"95d5":function(e,t,a){var i=a("40c3"),r=a("5168")("iterator"),n=a("481b");e.exports=a("584a").isIterable=function(e){var t=Object(e);return void 0!==t[r]||"@@iterator"in t||n.hasOwnProperty(i(t))}},"9d66":function(e,t,a){"use strict";var i=a("42e6"),r=a.n(i);r.a},a745:function(e,t,a){e.exports=a("f410")},aa77:function(e,t,a){var i=a("5ca1"),r=a("be13"),n=a("79e5"),o=a("fdef"),s="["+o+"]",c="​",l=RegExp("^"+s+s+"*"),u=RegExp(s+s+"*$"),d=function(e,t,a){var r={},s=n((function(){return!!o[e]()||c[e]()!=c})),l=r[e]=s?t(f):o[e];a&&(r[a]=l),i(i.P+i.F*s,"String",r)},f=d.trim=function(e,t){return e=String(r(e)),1&t&&(e=e.replace(l,"")),2&t&&(e=e.replace(u,"")),e};e.exports=d},b95a:function(e,t,a){"use strict";var i=a("26ef"),r=a.n(i);r.a},b964:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return o}));var i=a("b775");function r(e){return Object(i["a"])({url:"/datasource/sources/",method:"get",params:e})}function n(e){return Object(i["a"])({url:"datasource/sources/",method:"delete",data:e})}function o(e,t){return Object(i["a"])({url:"/datasource/sources/".concat(e.id,"/"),method:"put",data:t})}},c5f6:function(e,t,a){"use strict";var i=a("7726"),r=a("69a8"),n=a("2d95"),o=a("5dbc"),s=a("6a99"),c=a("79e5"),l=a("9093").f,u=a("11e9").f,d=a("86cc").f,f=a("aa77").trim,p="Number",m=i[p],h=m,b=m.prototype,v=n(a("2aeb")(b))==p,g="trim"in String.prototype,_=function(e){var t=s(e,!1);if("string"==typeof t&&t.length>2){t=g?t.trim():f(t,3);var a,i,r,n=t.charCodeAt(0);if(43===n||45===n){if(a=t.charCodeAt(2),88===a||120===a)return NaN}else if(48===n){switch(t.charCodeAt(1)){case 66:case 98:i=2,r=49;break;case 79:case 111:i=8,r=55;break;default:return+t}for(var o,c=t.slice(2),l=0,u=c.length;l<u;l++)if(o=c.charCodeAt(l),o<48||o>r)return NaN;return parseInt(c,i)}}return+t};if(!m(" 0o1")||!m("0b1")||m("+0x1")){m=function(e){var t=arguments.length<1?0:e,a=this;return a instanceof m&&(v?c((function(){b.valueOf.call(a)})):n(a)!=p)?o(new h(_(t)),a,m):_(t)};for(var y,w=a("9e1e")?l(h):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),D=0;w.length>D;D++)r(h,y=w[D])&&!r(m,y)&&d(m,y,u(h,y));m.prototype=b,b.constructor=m,a("2aba")(i,p,m)}},c8bb:function(e,t,a){e.exports=a("54a1")},d2d5:function(e,t,a){a("1654"),a("549b"),e.exports=a("584a").Array.from},f410:function(e,t,a){a("1af6"),e.exports=a("584a").Array.isArray},fdef:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);